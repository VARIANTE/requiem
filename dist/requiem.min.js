!function(e,t,n){"use strict";var i=t;"undefined"!=typeof module&&module.exports?module.exports=i:"function"==typeof define&&"object"==typeof define.amd?define("requiem",[],i):e.requiem=i}("undefined"!=typeof window?window:this,function(){var e,t,n;return function(i){function r(e,t){return b.call(e,t)}function s(e,t){var n,i,r,s,a,o,l,u,d,h,p,f=t&&t.split("/"),c=E.map,m=c&&c["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),a=e.length-1,E.nodeIdCompat&&w.test(e[a])&&(e[a]=e[a].replace(w,"")),e=f.slice(0,f.length-1).concat(e),d=0;d<e.length;d+=1)if(p=e[d],"."===p)e.splice(d,1),d-=1;else if(".."===p){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||m)&&c){for(n=e.split("/"),d=n.length;d>0;d-=1){if(i=n.slice(0,d).join("/"),f)for(h=f.length;h>0;h-=1)if(r=c[f.slice(0,h).join("/")],r&&(r=r[i])){s=r,o=d;break}if(s)break;!l&&m&&m[i]&&(l=m[i],u=d)}!s&&l&&(s=l,o=u),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function a(e,t){return function(){var n=O.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),f.apply(i,n.concat([e,t]))}}function o(e){return function(t){return s(t,e)}}function l(e){return function(t){v[e]=t}}function u(e){if(r(y,e)){var t=y[e];delete y[e],g[e]=!0,p.apply(i,t)}if(!r(v,e)&&!r(g,e))throw new Error("No "+e);return v[e]}function d(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function h(e){return function(){return E&&E.config&&E.config[e]||{}}}var p,f,c,m,v={},y={},E={},g={},b=Object.prototype.hasOwnProperty,O=[].slice,w=/\.js$/;c=function(e,t){var n,i=d(e),r=i[0];return e=i[1],r&&(r=s(r,t),n=u(r)),r?e=n&&n.normalize?n.normalize(e,o(t)):s(e,t):(e=s(e,t),i=d(e),r=i[0],e=i[1],r&&(n=u(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},m={require:function(e){return a(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:h(e)}}},p=function(e,t,n,s){var o,d,h,p,f,E,b=[],O=typeof n;if(s=s||e,"undefined"===O||"function"===O){for(t=!t.length&&n.length?["require","exports","module"]:t,f=0;f<t.length;f+=1)if(p=c(t[f],s),d=p.f,"require"===d)b[f]=m.require(e);else if("exports"===d)b[f]=m.exports(e),E=!0;else if("module"===d)o=b[f]=m.module(e);else if(r(v,d)||r(y,d)||r(g,d))b[f]=u(d);else{if(!p.p)throw new Error(e+" missing "+d);p.p.load(p.n,a(s,!0),l(d),{}),b[f]=v[d]}h=n?n.apply(v[e],b):void 0,e&&(o&&o.exports!==i&&o.exports!==v[e]?v[e]=o.exports:h===i&&E||(v[e]=h))}else e&&(v[e]=n)},e=t=f=function(e,t,n,r,s){if("string"==typeof e)return m[e]?m[e](t):u(c(e,t).f);if(!e.splice){if(E=e,E.deps&&f(E.deps,E.callback),!t)return;t.splice?(e=t,t=n,n=null):e=i}return t=t||function(){},"function"==typeof n&&(n=r,r=s),r?p(i,e,t,n):setTimeout(function(){p(i,e,t,n)},4),f},f.config=function(e){return f(e)},e._defined=v,n=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),r(v,e)||r(y,e)||(y[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("helpers/injectModule",[],function(){function e(e,t,n){Object.defineProperty(e,t,{value:n,writable:!1});for(var i in n)n.hasOwnProperty(i)&&Object.defineProperty(e,i,{value:n[i],writable:!1})}return e}),n("helpers/polyfill",[],function(){function e(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}window&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}return e}),n("helpers/assert",[],function(){function e(e,t){if(!e)throw new Error(t||"Assert failed");return e}return e}),n("helpers/assertType",["helpers/assert"],function(e){function t(t,i,r,s){if(e(void 0!==i,"Paremeter 'type' must be a string or a class")&&e(void 0===r||"boolean"==typeof r,"Paremeter 'allowUndefined', if specified, must be a boolean")&&e(void 0===s||"string"==typeof s,"Parameter 'message', if specified, must be a string")){r=void 0===r?!1:r;var a=!1;if(r&&void 0===t)a=!0;else if(i instanceof Array){for(var o=i.length,l=0;o>l;l++)if(n(t,i[l])){a=!0;break}}else a=n(t,i);if(!a)throw new Error(s||"AssertType failed");return a}}function n(e,t){if("string"!=typeof t)return e instanceof t;switch(t){case"string":case"object":case"number":case"boolean":case"function":return typeof e===t;case"class":return"function"==typeof e;case"array":return e instanceof Array;default:return!1}}return t}),n("dom/namespace",["helpers/assertType"],function(e){function t(t,n){e(t,"string",!1,"Invalid parameter: identifiers"),e(n,"object",!0,"Invalid optional parameter: scope");for(var i=window?window:{},r=t.split("."),s=void 0===n||null===n?i:n,a=0;a<r.length;a++)s=s[r[a]]||(s[r[a]]={});return s}return t}),n("dom/ready",["helpers/assertType"],function(e){function t(t){if(e(t,"function",!1,"Invalid parameter: callback"),!document)return null;var n=function(e){document.addEventListener?(document.removeEventListener("DOMContentLoaded",n,!1),window.removeEventListener("load",n,!1)):document.attachEvent&&(document.detachEvent("onreadystatechange",n),window.detachEvent("onload",n)),setTimeout(t,1)};return"complete"===document.readyState?setTimeout(t,1):(document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",n),window.attachEvent("onload",n)),null)}return t}),n("types/Directives",{Controller:"r-controller",Instance:"r-instance",State:"r-state",Property:"r"}),n("helpers/isNull",["helpers/assert","helpers/assertType"],function(e,t){function n(e,i){if(t(i,"boolean",!0,"Invalid parameter: recursive"),void 0===i&&(i=!1),void 0===e||null===e)return!0;if(i&&e instanceof Array){for(var r=e.length,s=0;r>s;s++)if(!n(e[s],!0))return!1;return!0}if(i&&"object"==typeof e){for(var a in e)if(!n(e[a],!0))return!1;return!0}return!1}return n}),n("helpers/log",[],function(){function e(){window&&window.VARS_DEBUG&&window.console&&console.log&&Function.apply.call(console.log,console,arguments)}return e}),n("helpers/validateAttribute",["types/Directives"],function(e){function t(t){for(var n in e){if(t===n)return!1;if(t==="data-"+n)return!1}return!0}return t}),n("types/DirtyType",{NONE:0,POSITION:1,SIZE:2,LAYOUT:4,STATE:8,DATA:16,LOCALE:32,DEPTH:64,CONFIG:128,STYLE:256,SCHEME:512,INPUT:1024,ORIENTATION:2048,CUSTOM:4096,ALL:4294967295}),n("types/NodeState",{IDLE:0,INITIALIZED:1,UPDATED:2,DESTROYED:3}),n("types/EventType",{DATA:{CHANGE:"datachange"},MOUSE:{CLICK:"click",CONTEXT_MENU:"contextmenu",CLICK_OUTSIDE:"clickoutside",DOUBLE_CLICK:"dblclick",MOUSE_DOWN:"mousedown",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_MOVE:"mousemove",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",MOUSE_UP:"mouseup"},KEYBOARD:{KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup"},DEVICE:{DEVICE_ORIENTATION:"deviceorientation",DEVICE_MOTION:"devicemotion",ORIENTATION:"MozOrientation",ORIENTATION_CHANGE:"orientationchange"},OBJECT:{ABORT:"abort",BEFORE_UNLOAD:"beforeunload",ERROR:"error",HASH_CHANGE:"hashchange",LOAD:"load",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",PROGRESS:"progress"},FORM:{BLUR:"blur",CHANGE:"change",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",INPUT:"input",INVALID:"invalid",RESET:"reset",SEARCH:"search",SELECT:"select",SUBMIT:"submit"},DRAG:{DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DRAG_START:"dragstart",DROP:"drop"},CLIPBOARD:{COPY:"copy",CUT:"cut",PASTE:"paste"},PRINT:{AFTER_PRINT:"afterprint",BEFORE_PRINT:"beforeprint"},MEDIA:{ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting"},ANIMATION:{ANIMATION_END:"animationend",ANIMATION_ITERATION:"animationiteration",ANIMATION_START:"animationstart"},TRANSITION:{TRANSITION_END:"transitionend"},SERVER_SENT:{ERROR:"error",MESSAGE:"message",OPEN:"open"},MISC:{MESSAGE:"message",ONLINE:"online",OFFLINE:"offline",POP_STATE:"popstate",SHOW:"show",STORAGE:"storage",TOGGLE:"toggle",WHEEL:"wheel"},TOUCH:{TOUCH_CANCEL:"touchcancel",TOUCH_END:"touchend",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart"}}),n("helpers/debounce",["helpers/assertType"],function(e){function t(t,n,i){e(t,"function",!1,"Invalid parameter: method"),e(n,"number",!0,"Invalid optional parameter: delay"),e(i,"boolean",!0,"Invalid optional parameter: leading"),void 0===n&&(n=0),void 0===i&&(i=!1);var r;return function(){var e=this,s=arguments,a=function(){r=null,i||t.apply(e,s)},o=i&&!r;clearTimeout(r),r=setTimeout(a,n),o&&t.apply(e,s)}}return t}),n("ui/ElementUpdateDelegate",["helpers/assert","helpers/debounce","helpers/log","types/DirtyType","types/EventType"],function(e,t,n,i,r){function s(e){n("[ElementUpdateDelegate]::new(",e,")"),this.__define_properties();var s=0,a=null,o=null,l=null,u=null,d=null,h=null,p=null,f=null;this.delegate=e,this.setDirty=function(e,t){if(n("[ElementUpdateDelegate]::setDirty(",e,t,")"),this.transmissive!==i.NONE&&this.delegate.children)for(var r in this.delegate.children){var a;a=this.delegate.children[r]instanceof Array?this.delegate.children[r]:[this.delegate.children[r]];for(var o=a.length,l=0;o>l;l++){var u=a[l];if(u.updateDelegate&&u.updateDelegate.setDirty){var d=e&u.updateDelegate.receptive;d!==i.NONE&&u.updateDelegate.setDirty(d,t)}}}if(!this.isDirty(e)||t){switch(e){case i.NONE:case i.ALL:s=e;break;default:s|=e}t?this.update():this._pendingAnimationFrame||(this._pendingAnimationFrame=c(this.update.bind(this)))}},this.isDirty=function(e){switch(n("[ElementUpdateDelegate]::isDirty(",e,s,")"),e){case i.NONE:case i.ALL:return s===e;default:return 0!==(e&s)}},this.init=function(){n("[ElementUpdateDelegate]::init()");var e=this.conductor||window;window&&e&&e.addEventListener&&(this.responsive===!0||this.responsive instanceof Array)&&((this.responsive===!0||this.responsive.indexOf(r.OBJECT.RESIZE)>-1||this.responsive.indexOf(r.DEVICE.ORIENTATION_CHANGE)>-1)&&(a=0===this.refreshRate?v.bind(this):t(v.bind(this),this.refreshRate)),(this.responsive===!0||this.responsive.indexOf(r.OBJECT.SCROLL)>-1)&&(o=0===this.refreshRate?y.bind(this):t(y.bind(this),this.refreshRate)),(this.responsive===!0||this.responsive.indexOf(r.MISC.WHEEL)>-1)&&(d=0===this.refreshRate?g.bind(this):t(g.bind(this),this.refreshRate)),(this.responsive===!0||this.responsive.indexOf(r.MOUSE.MOUSE_MOVE)>-1)&&(l=0===this.refreshRate?E.bind(this):t(E.bind(this),this.refreshRate)),(this.responsive===!0||this.responsive.indexOf(r.DEVICE.DEVICE_ORIENTATION)>-1||this.responsive.indexOf(r.DEVICE.DEVICE_MOTION)>-1||this.responsive.indexOf(r.DEVICE.ORIENTATION)>-1)&&(u=0===this.refreshRate?b.bind(this):t(b.bind(this),this.refreshRate)),(this.responsive===!0||this.responsive.indexOf(r.KEYBOARD.KEY_DOWN)>-1)&&(f=O.bind(this)),(this.responsive===!0||this.responsive.indexOf(r.KEYBOARD.KEY_PRESS)>-1)&&(p=w.bind(this)),(this.responsive===!0||this.responsive.indexOf(r.KEYBOARD.KEY_UP)>-1)&&(h=_.bind(this)),a&&(window.addEventListener(r.OBJECT.RESIZE,a),window.addEventListener(r.DEVICE.ORIENTATION_CHANGE,a)),o&&e.addEventListener(r.OBJECT.SCROLL,o),d&&e.addEventListener(r.MISC.WHEEL,d),l&&e.addEventListener(r.MOUSE.MOUSE_MOVE,l),u&&(window.DeviceOrientationEvent?window.addEventListener(r.DEVICE.DEVICE_ORIENTATION,u):window.DeviceMotionEvent&&window.addEventListener(r.DEVICE.DEVICE_MOTION,u)),f&&window.addEventListener(r.KEYBOARD.KEY_DOWN,f),p&&window.addEventListener(r.KEYBOARD.KEY_PRESS,p),h&&window.addEventListener(r.KEYBOARD.KEY_UP,h)),this.setDirty(i.ALL)},this.destroy=function(){n("[ElementUpdateDelegate]::destroy()"),m();var e=this.conductor||window;window&&e&&e.removeEventListener&&(a&&(window.removeEventListener(r.OBJECT.RESIZE,a),window.removeEventListener(r.DEVICE.ORIENTATION_CHANGE,a)),o&&e.removeEventListener(r.OBJECT.SCROLL,o),d&&e.removeEventListener(r.MISC.WHEEL,d),l&&e.removeEventListener(r.MOUSE.MOUSE_MOVE,l),u&&(window.DeviceOrientationEvent?window.removeEventListener(r.DEVICE.DEVICE_ORIENTATION,u):window.DeviceMotionEvent&&window.removeEventListener(r.DEVICE.DEVICE_MOTION,u)),f&&window.removeEventListener(r.KEYBOARD.KEY_DOWN,f),p&&window.removeEventListener(r.KEYBOARD.KEY_PRESS,p),h&&window.removeEventListener(r.KEYBOARD.KEY_UP,h)),a=null,o=null,d=null,l=null,u=null,f=null,p=null,h=null},this.update=function(){n("[ElementUpdateDelegate]::update()"),m(this._pendingAnimationFrame),this.delegate&&this.delegate.update&&this.delegate.update.call(this.delegate),this.setDirty(i.NONE),delete this.mouse.pointerX,delete this.mouse.pointerY,delete this.mouse.wheelX,delete this.mouse.wheelY,delete this.orientation.x,delete this.orientation.y,delete this.orientation.z,delete this.keyCode.up,delete this.keyCode.press,delete this.keyCode.down,this._pendingAnimationFrame=null};var c=function(e){var t=window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame)||null;return t||(t=function(e){return window?window.setTimeout(e,10):null}),t(e)},m=function(e){var t=window&&(window.requestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame)||null;return t||(t=function(e){return window?window.clearTimeout(e):null}),t},v=function(e){this.setDirty(i.SIZE)},y=function(e){this.setDirty(i.POSITION)},E=function(e){this.mouse.pointerX=e.clientX,this.mouse.pointerY=e.clientY,this.setDirty(i.INPUT)},g=function(e){this.mouse.wheelX=e.deltaX,this.mouse.wheelY=e.deltaY,this.setDirty(i.INPUT)},b=function(e){if(window){var t,n,r;e instanceof window.DeviceOrientationEvent?(t=e.beta,n=e.gamma,r=e.alpha):e instanceof window.DeviceMotionEvent?(t=2*e.acceleration.x,n=2*e.acceleration.y,r=2*e.acceleration.z):(t=50*e.orientation.x,n=50*e.orientation.y,r=50*e.orientation.z),this.orientation.x=t,this.orientation.y=n,this.orientation.z=r,this.setDirty(i.ORIENTATION)}},O=function(e){window&&(void 0===this.keyCode.down&&(this.keyCode.down=[]),this.keyCode.down.push(e.keyCode),this.setDirty(i.INPUT))},w=function(e){window&&(void 0===this.keyCode.press&&(this.keyCode.press=[]),this.keyCode.press.push(e.keyCode),this.setDirty(i.INPUT))},_=function(e){window&&(void 0===this.keyCode.up&&(this.keyCode.up=[]),this.keyCode.up.push(e.keyCode),this.setDirty(i.INPUT))}}var a=0;return s.prototype.__define_properties=function(){Object.defineProperty(this,"delegate",{value:null,writable:!0}),Object.defineProperty(this,"responsive",{value:!1,writable:!0}),Object.defineProperty(this,"refreshRate",{value:a,writable:!0}),Object.defineProperty(this,"transmissive",{value:i.NONE,writable:!0}),Object.defineProperty(this,"receptive",{value:i.NONE,writable:!0}),Object.defineProperty(this,"conductor",{value:window,writable:!0}),Object.defineProperty(this,"mouse",{value:{},writable:!1}),Object.defineProperty(this,"orientation",{value:{},writable:!1}),Object.defineProperty(this,"keyCode",{value:{},writable:!1})},s.prototype.toString=function(){return"[ElementUpdateDelegate{"+(this.delegate&&this.delegate.name||"undefined")+"}]"},s}),n("ui/Element",["helpers/assert","helpers/assertType","helpers/isNull","helpers/log","helpers/validateAttribute","types/DirtyType","types/NodeState","types/EventType","types/Directives","ui/ElementUpdateDelegate"],function(e,t,n,i,r,s,a,o,l,u){function d(e){if(this._nodeState=a.IDLE,this.__define_properties(),void 0!==e)if(e instanceof HTMLElement)this.element=e;else if("string"==typeof e)this.name=e;else if("object"==typeof e)for(var t in e)if(this.hasOwnProperty(t))if("children"===t){var n=e.children;for(var o in n)this.addChild(n[o],o)}else this[t]=e[t];for(var u=this.element.attributes,h=u.length,p=new RegExp("^"+l.Property+"-|^data-"+l.Property+"-","i"),f=0;h>f;f++){var c=u[f];if(r(c.name)&&p.test(c.name)){var m=c.name.replace(p,"").replace(/-([a-z])/g,function(e){return e[1].toUpperCase()});d.defineProperty(this,m,{defaultValue:""===c.value?!0:c.value,attribute:c.name,dirtyType:s.DATA,get:!0,set:!0},"properties")}}i(this.toString()+":new(",e,")"),this.init()}return d.defineProperty=function(n,i,s,a){t(n,d,!1,"Parameter 'element' must be an Element instance"),t(s,"object",!1,"Parameter 'descriptor' must be an object literal"),t(s.configurable,"boolean",!0,"Optional configurable key in descriptor must be a boolean"),t(s.enumerable,"boolean",!0,"Optional enumerable key in descriptor must be a boolean"),t(s.writable,"boolean",!0,"Optional writable key in descriptor must be a boolean"),t(s.unique,"boolean",!0,"Optional unique key in descriptor must be a boolean"),t(s.dirtyType,"number",!0,"Optional dirty type must be of DirtyType enum (number)"),t(s.eventType,"string",!0,"Optional event type must be a string"),t(s.attribute,"string",!0,"Optional attribute must be a string"),t(s.onChange,"function",!0,"Optional change handler must be a function"),t(a,"string",!0,"Optional parameter 'scope' must be a string"),e(r(s.attribute),"Attribute '"+s.attribute+"' is reserved");var o=s.dirtyType,l=s.defaultValue,u=s.attribute,h=s.eventType,p=s.unique;void 0===p&&(p=!0),void 0===a?a=n:(e(n.hasOwnProperty(a),"The specified Element instance does not have a property called '"+a+"'"),a=n[a]),void 0!==l&&Object.defineProperty(a,"__"+i,{value:l,writable:!0});var f={};void 0!==s.configurable&&(f.configurable=s.configurable),void 0!==s.enumerable&&(f.enumerable=s.enumerable),void 0!==s.value&&(f.value=s.value),void 0!==s.writable&&(f.writable=s.writable),s.get&&(f.get=function(){return"function"==typeof s.get?s.get(this["__"+i]):this["__"+i]}.bind(a)),s.set&&(f.set=function(e){var t=this["__"+i];if((!p||t!==e)&&("function"==typeof s.set&&(e=s.set(e)),void 0===t?Object.defineProperty(this,"__"+i,{value:e,writable:!0}):this["__"+i]=e,void 0!==s.onChange&&s.onChange(t,e),void 0!==u&&n.setAttribute(u,e),void 0!==o&&n.setDirty(o),void 0!==h)){var r=new CustomEvent(h,{detail:{property:i,oldValue:t,newValue:e}});n.dispatchEvent(r)}}.bind(a)),Object.defineProperty(a,i,f),void 0!==l&&void 0!==u&&n.setAttribute(u,l)},d.prototype.init=function(){i(this.toString()+"::init()"),this._nodeState=a.INITIALIZED,this.updateDelegate.init();for(var e in this.children){var t=this.children[e];if(t instanceof Array)for(var n=t.length,r=0;n>r;r++){var s=t[r];(s.nodeState===a.IDLE||s.nodeState===a.DESTROYED)&&s.init()}else(t.nodeState===a.IDLE||t.nodeState===a.DESTROYED)&&t.init()}},d.prototype.destroy=function(){i(this.toString()+"::destroy()");for(var e in this.children){var t=this.children[e];if(t instanceof Array)for(var n=t.length,r=0;n>r;r++){var s=t[r];s.nodeState!==a.DESTROYED&&s.destroy()}else t.nodeState!==a.DESTROYED&&t.destroy()}this.removeAllEventListeners(),this.updateDelegate.destroy(),this._nodeState=a.DESTROYED},d.prototype.update=function(){i(this.toString()+"::update()"),this._nodeState=a.UPDATED},d.prototype.respondsTo=function(){var t=Array.prototype.slice.call(arguments),n=t.length;e(n>0,"Too few arguments")&&e(this.nodeState===a.IDLE,"Responsiveness must be defined when the node state of this element is IDLE")&&(isNaN(t[0])?(this.updateDelegate.conductor=t.shift(),this.updateDelegate.refreshRate=t.shift()):this.updateDelegate.refreshRate=t.shift(),0===t.length?this.updateDelegate.responsive=!0:this.updateDelegate.responsive=t)},d.prototype.addChild=function(n,i){if(e(void 0!==n,"Parameter 'child' must be specified"))if(n.jquery)this.addChild(n.get(),i);else if(n instanceof Array)for(var r=n.length,s=0;r>s;s++){var o=n[s];this.addChild(o,i)}else{if(!t(n,[HTMLElement,d],!1,"Invalid child specified. Child must be an instance of HTMLElement or Requiem Element."))return;if(n instanceof HTMLElement&&(n=new d({element:n,name:i})),i=i||n.name,!e(i||n.name,"Either child name was unprovided or it cannot be deducted from the specified child"))return null;if(this.children[i])if(this.children[i]instanceof Array)this.children[i].push(n);else{var l=[this.children[i]];l.push(n),this.children[i]=l}else this.children[i]=n;n.name=i,(n.nodeState===a.IDLE||n.nodeState===a.DESTROYED)&&n.init();var u=!0;if(n.element.parentNode&&document)for(var h=n.element;null!==h&&void 0!==h&&h!==document;)if(h=h.parentNode,h===this.element){u=!1;break}u&&this.element.appendChild(n.element)}},d.prototype.hasChild=function(t){if(!e(void 0!==t,"Child is undefined"))return!1;if("string"==typeof t)return!n(this.getChild(t));var i;for(t.jquery&&1===t.length?i=t.get(0):t instanceof d?i=t.element:t instanceof HTMLElement&&(i=t);!n(i)&&i!==document;)if(i=i.parentNode,i===this.element)return!0;return!1},d.prototype.removeChild=function(t){if(e(!n(t,!0),"No valid child specified"))if("string"==typeof t)this.removeChild(this.getChild(t));else if(t instanceof Array||t.jquery&&t.length>1)for(;t.length>0;)this.removeChild(t[0]);else if(this.hasChild(t)){var i;if(t.jquery&&1===t.length?i=t.get(0):t instanceof d?i=t.element:t instanceof HTMLElement&&(i=t),n(i))return;for(var r in this.children){var s=this.children[r];if(s instanceof Array){for(var a=s.length,o=0,l=0;a>l;l++){var u=s[l];if(o=l,u.element===i){u.destroy(),i.parentNode.removeChild(i);break}}s.splice(o,1),0===s.length&&delete this.children[r]}else s instanceof d&&(s.element===i?(s.destroy(),i.parentNode.removeChild(i),delete this.children[r]):s.removeChild(t))}}},d.prototype.getChild=function(e,i){if(!t(e,"string",!1,"Child name must be specified"))return null;if(!t(i,"boolean",!0,"Parameter 'recursive', if specified, must be a boolean"))return null;i=void 0===i?!0:i;var r=e.split("."),s=r.shift(),a=this.children[s];if(i&&r.length>0){if(a instanceof Array){for(var o=[],l=a.length,u=0;l>u;u++){var h=a[u];h instanceof d?o.push(h.getChild(r.join("."))):o.push(null)}return n(o,!0)?null:o}return a instanceof d?a.getChild(r.join(".")):null}return n(a,!0)?null:a},d.prototype.addEventListener=function(){var e=arguments[0],t=arguments[1],n=arguments[2]||!1;if(this.cachesListeners){this._listenerMap||Object.defineProperty(this,"_listenerMap",{value:{},writable:!1}),this._listenerMap[e]||(this._listenerMap[e]=[]);var i=this._listenerMap[e],r=i.length,s=!0;if(e===o.MOUSE.CLICK_OUTSIDE){var a=t;t=function(e){e.target===this.element||this.hasChild(e.target)||a(e)}.bind(this)}for(var l=0;r>l;l++){var u=i[l];if(u.listener===t){s=!1;break}}s&&i.push({listener:t,useCapture:n})}window&&e===o.MOUSE.CLICK_OUTSIDE?window.addEventListener(o.MOUSE.CLICK,t,n):this.element.addEventListener.apply(this.element,arguments)},d.prototype.hasEventListener=function(e,t){if(!this._listenerMap)return!1;if(!this._listenerMap[e])return!1;if(t){for(var n=this._listenerMap[e],i=n.length,r=0;i>r;r++){var s=n[r];if(s.listener===t)return!0}return!1}return!0},d.prototype.removeEventListener=function(){var e=arguments[0],t=arguments[1],n=arguments[2]||!1;if(this._listenerMap){var i=this._listenerMap[e],r=i.length,s=-1;if(t){for(var a=0;r>a;a++){var l=i[a];if(l.listener===t){s=a;break}}s>-1&&(i.splice(s,1),0===i.length&&(this._listenerMap[e]=null,delete this._listenerMap[e]))}else for(;void 0!==this._listenerMap[e];)this.removeEventListener(e,this._listenerMap[e][0].listener,this._listenerMap[e][0].useCapture)}t&&(window&&e===o.MOUSE.CLICK_OUTSIDE?window.removeEventListener(o.MOUSE.CLICK,t,n):this.element.removeEventListener.apply(this.element,arguments))},d.prototype.removeAllEventListeners=function(){if(this._listenerMap)for(var e in this._listenerMap)this.removeEventListener(e)},d.prototype.dispatchEvent=function(e){this.element.dispatchEvent(e)},d.prototype.addClass=function(t){var n=[];if(e("string"==typeof t||t instanceof Array,"Invalid class name specified. Must be either a string or an array of strings.")){"string"==typeof t?n.push(t):n=t;for(var i=n.length,r=0;i>r;r++){var s=n[r];e("string"==typeof s,"Invalid class detected: "+s)&&(this.hasClass(s)||(this.element.className=this.element.className+(""===this.element.className?"":" ")+s))}}},d.prototype.removeClass=function(t){var n=[];if(e("string"==typeof t||t instanceof Array,"Invalid class name specified. Must be either a string or an array of strings.")){"string"==typeof t?n.push(t):n=t;for(var i=n.length,r=0;i>r;r++){var s=n[r];if(e("string"==typeof s,"Invalid class detected: "+s)){var a=new RegExp("^"+s+"\\s+|\\s+"+s+"|^"+s+"$","g");this.element.className=this.element.className.replace(a,"")}}}},d.prototype.hasClass=function(t){return e("string"==typeof t,"Invalid class detected: "+t)?this.classes.indexOf(t)>-1:!1},d.prototype.getAttribute=function(e){return this.element.getAttribute(e)},d.prototype.setAttribute=function(t,n){e(r(t),"Attribute '"+t+"' is reserved")&&(void 0===n||null===n?this.element.setAttribute(t,""):this.element.setAttribute(t,n))},d.prototype.removeAttribute=function(e){this.element.removeAttribute(e)},d.prototype.hasAttribute=function(e){return!n(this.element.getAttribute(e))},d.prototype.getStyle=function(e){var t=this.element.style[e];return""===t?null:t},d.prototype.setStyle=function(e,t){"number"==typeof t&&(t+="px"),this.element.style[e]=t},d.prototype.removeStyle=function(e){this.element.style[e]=""},d.prototype.hasStyle=function(e){return""!==this.element.style[e]},d.prototype.factory=function(){return document.createElement("div")},d.prototype.isDirty=function(){return this.updateDelegate.isDirty.apply(this.updateDelegate,arguments)},d.prototype.setDirty=function(){return this.updateDelegate.setDirty.apply(this.updateDelegate,arguments)},d.prototype.toString=function(){return"[Element{"+this.name+"}]"},d.prototype.__define_properties=function(){Object.defineProperty(this,"element",{get:function(){return this._element||Object.defineProperty(this,"_element",{value:this.factory(),writable:!0}),this._element},set:function(e){this.__set_element(e)}}),Object.defineProperty(this,"id",{get:function(){return this.element.id},set:function(e){this.element.setAttribute("id",e)}}),Object.defineProperty(this,"name",{get:function(){var e=this.element.getAttribute(l.Instance)||this.element.getAttribute("data-"+l.Instance);return e&&""!==e?e:null},set:function(e){e&&""!==e&&(this.name||this.element.setAttribute("data-"+l.Instance,e))}}),Object.defineProperty(this,"classes",{get:function(){return this.element.className.split(" ")},set:function(e){this.element.className=e.join(" ")}}),Object.defineProperty(this,"attributes",{get:function(){return this.element.attributes}}),Object.defineProperty(this,"styles",{get:function(){return this.element.style}}),Object.defineProperty(this,"nodeState",{get:function(){return this._nodeState||a.IDLE}}),Object.defineProperty(this,"state",{get:function(){var e=this.element.getAttribute(l.State)||this.element.getAttribute("data-"+l.State);return e&&""!==e?e:null},set:function(e){this.state!==e&&(null===e||void 0===e?(this.element.removeAttribute(l.State),this.element.removeAttribute("data-"+l.State)):this.element.setAttribute("data-"+l.State,e),this.updateDelegate.setDirty(s.STATE))}}),Object.defineProperty(this,"children",{value:{},writable:!1}),Object.defineProperty(this,"data",{value:{},writable:!0}),Object.defineProperty(this,"properties",{value:{},writable:!1}),Object.defineProperty(this,"updateDelegate",{get:function(){return this._updateDelegate||Object.defineProperty(this,"_updateDelegate",{value:new u(this),writable:!1}),this._updateDelegate}}),Object.defineProperty(this,"cachesListeners",{value:!0,writable:!0})},d.prototype.__set_element=function(t){e(!this._element,"Element cannot be overwritten."),e(t instanceof HTMLElement||t instanceof d,"Invalid element type specified. Must be an instance of HTMLElement or Element."),t instanceof d?Object.defineProperty(this,"_element",{value:t.element,writable:!0}):Object.defineProperty(this,"_element",{value:t,writable:!0})},d}),n("helpers/inherit",["helpers/assertType"],function(e){function t(t,n){function i(){this.constructor=t}e(t,"class",!1,"Invalid parameter: childClass"),e(n,"class",!1,"Invalid parameter: parentClass");for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return i.prototype=Object.create(n.prototype),t.prototype=new i,t.__super__=n.prototype,t}return t}),n("ui/Video",["helpers/assert","helpers/inherit","helpers/log","types/DirtyType","ui/Element"],function(e,t,n,i,r){function s(){s.__super__.constructor.apply(this,arguments)}return t(s,r),s.PRELOAD={AUTO:"auto",METADATA:"metada",NONE:"none"},s.prototype.update=function(){this.updateDelegate.isDirty(i.DATA)&&this._updateSource(),this.updateDelegate.isDirty(i.CUSTOM),s.__super__.update.call(this)},s.prototype.factory=function(){return document.createElement("video")},s.prototype._updateSource=function(){var e,t,n=this.element.getElementsByTagName("source");for(t=n.length,e=0;t>e;e++){var i=n[e];this.element.removeChild(i)}if(this.source)for(t=this.source.length,e=0;t>e;e++){var r=document.createElement("source"),s=this.source[e].src,a=this.source[e].type,o=s.split(".").pop();r.setAttribute("src",s),r.setAttribute("type",a||"video/"+o),this.element.appendChild(r)}},s.prototype.toString=function(){return"[Video{"+this.name+"}]"},s.prototype.__define_properties=function(){Object.defineProperty(this,"autoplay",{get:function(){return this.element.autoplay},set:function(e){this.element.autoplay=e,this.updateDelegate.setDirty(i.CUSTOM)}}),Object.defineProperty(this,"controls",{get:function(){return this.element.controls},set:function(e){this.element.controls=e,this.updateDelegate.setDirty(i.CUSTOM)}}),Object.defineProperty(this,"loop",{get:function(){return this.element.loop},set:function(e){this.element.loop=e,this.updateDelegate.setDirty(i.CUSTOM)}}),Object.defineProperty(this,"muted",{get:function(){return this.element.muted},set:function(e){this.element.muted=e,this.updateDelegate.setDirty(i.CUSTOM)}}),Object.defineProperty(this,"poster",{get:function(){return this.element.poster},set:function(e){this.element.poster=e,this.updateDelegate.setDirty(i.CUSTOM)}}),Object.defineProperty(this,"preload",{get:function(){return this.element.preload},set:function(e){this.element.preload=e,this.updateDelegate.setDirty(i.CUSTOM)}}),Object.defineProperty(this,"source",{get:function(){return this._source},set:function(e){Object.defineProperty(this,"_source",{value:e,writable:!0}),this.updateDelegate.setDirty(i.DATA)}}),s.__super__.__define_properties.call(this)},s.prototype.__set_element=function(t){e(t instanceof HTMLVideoElement,"Invalid element type specified. Must be an instance of HTMLVideoElement."),s.__super__.__set_element.call(this,t)},s}),n("helpers/toElementArray",["ui/Element","helpers/assert"],function(e,t){function n(n,i){if(!n)return null;var r;if(n instanceof Array)r=n;else if(n instanceof NodeList)r=Array.prototype.slice.call(n);else if(n.jquery)r=n.get();else{if(!t(n instanceof HTMLElement||n instanceof e,"Invalid element specified. Element must be an instance of HTMLElement or Requiem Element."))return null;n instanceof HTMLElement?r=[n]:n instanceof e&&(r=[n.element])}for(var s=r.length,a=0;s>a;a++){var o=r[a];if(!t(o instanceof HTMLElement||o instanceof e,"Element array contains invalid element(s). Each element must be an instance of HTMLElement or Requiem Element."))return null;!i&&o instanceof e&&(r[a]=o.element)}return r}return n}),n("utils/hasChild",["helpers/assert","helpers/toElementArray"],function(e,t){function n(n,i){var r=t(n),s=t(i);if(!e(1===r.length,"Invalid parent specified. Parent must be a single HTMLElement, Requiem Element, or jQuery object."))return!1;if(!e(1===s.length,"Invalid child specified. Child must be a single HTMLElement, Requiem Element, or jQuery object."))return!1;if(!e(document,"Document not found. This method requires document to be valid."))return!1;
var a=r[0],o=s[0];if(!o.parentNode)return!1;for(;null!==o&&void 0!==o&&o!==document;)if(o=o.parentNode,o===a)return!0;return!1}return n}),n("dom/sightread",["dom/namespace","dom/ready","helpers/assert","types/Directives","ui/Element","ui/Video","utils/hasChild"],function(e,t,n,i,r,s,a){function o(e,n){void 0===n&&(n=document),t(function(){l(n,e)})}function l(t,a){var o=null;if(t||(t=document),t.jquery&&(t=t.get(0)),!n(t instanceof HTMLElement||t instanceof r||document&&t===document,"Element must be an instance of an HTMLElement or the DOM itself."))return null;t instanceof r&&(t=t.element);for(var d=t.querySelectorAll("["+i.Controller+"], [data-"+i.Controller+"], ["+i.Instance+"], [data-"+i.Instance+"]"),h=u(d),p=h.length,f=0;p>f;f++){var c=h[f],m=c.getAttribute(i.Controller)||c.getAttribute("data-"+i.Controller),v=c.getAttribute(i.Instance)||c.getAttribute("data-"+i.Instance),y=m?e(m,a):null;if(!y&&v&&v.length>0)y=r;else if("function"!=typeof y)switch(m){case"Video":y=s;break;case"Element":y=r;break;default:y=null}if(n("function"==typeof y,'Class "'+m+'" is not found in specified controllerScope '+(a||window)+".")){var E=new y({element:c,name:v,children:l(c,a)});if(v&&v.length>0)if(o||(o={}),o[v])if(o[v]instanceof Array)o[v].push(E);else{var g=[o[v]];g.push(E),o[v]=g}else o[v]=E}}return o}function u(e){for(var t=e.length,n=[],i=0;t>i;i++){for(var r=!0,s=e[i],o=0;t>o;o++)if(i!==o){var l=e[o];if(a(l,s)){r=!1;break}}r&&n.push(s)}return n}return o}),n("dom",["dom/namespace","dom/ready","dom/sightread"],function(e,t,n){var i={};return Object.defineProperty(i,"namespace",{value:e,writable:!1,enumerable:!0}),Object.defineProperty(i,"ready",{value:t,writable:!1,enumerable:!0}),Object.defineProperty(i,"sightread",{value:n,writable:!1,enumerable:!0}),i}),n("events/EventDispatcher",["helpers/assert","helpers/assertType","helpers/log"],function(e,t,n){function i(e){this.__define_properties()}return i.prototype.addEventListener=function(e,i){t(e,"string",!1,"Invalid parameter: type")&&t(i,"function",!1,"Invalid parameter: listener")&&(n("[EventDispatcher]::addEventListener("+e+")"),this._listenerMap||Object.defineProperty(this,"_listenerMap",{value:{},writable:!0}),this._listenerMap[e]||(this._listenerMap[e]=[]),this._listenerMap[e].push(i))},i.prototype.removeEventListener=function(i,r){if(t(i,"string",!1,"Invalid parameter: type")&&t(r,"function",!0,"Invalid parameter: listener")&&e(this._listenerMap,"Listener map is null.")&&e(this._listenerMap[i],"There are no listeners registered for event type: "+i))if(n("[EventDispatcher]::removeEventListener("+i+")"),r){var s=this._listenerMap[i].indexOf(r);s>-1&&this._listenerMap[i].splice(s,1)}else delete this._listenerMap[i]},i.prototype.hasEventListener=function(n,i){if(t(n,"string",!1,"Invalid parameter: type")&&t(i,"function",!0,"Invalid parameter: listener")&&e(this._listenerMap,"Listener map is null.")&&e(this._listenerMap[n],"There are no listeners registered for event type: "+n)){if(i){var r=this._listenerMap[n].indexOf(i);return r>-1}return!0}},i.prototype.dispatchEvent=function(i){if(t(i,Event,!1,"Event must be specified.")&&e(this._listenerMap,"Listener map is null.")&&this._listenerMap[i.type]){n("[EventDispatcher]::dispatchEvent("+i.type+")"),i.target=this,i.currentTarget=this,i.customTarget=this;for(var r=this._listenerMap[i.type].length,s=0;r>s;s++){var a=this._listenerMap[i.type][s];a.call(this,i)}}},i.prototype.__define_properties=function(){},i}),n("events",["events/EventDispatcher"],function(e){var t={};return Object.defineProperty(t,"EventDispatcher",{value:e,writable:!1,enumerable:!0}),t}),n("net/AssetLoader",["events/EventDispatcher","helpers/assert","helpers/inherit","helpers/log","types/EventType"],function(e,t,n,i,r){function s(){s.__super__.constructor.apply(this,arguments)}var a=["jpg","png","svg","jpeg","gif"],o=["mp4","mpeg","ogg","ogv","mov","avi","flv"],l=["mp3","mp4","mpeg","flac","wav","ogg"],u={IMAGE:{jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg"},VIDEO:{mp4:"video/mp4",mov:"video/quicktime",mpeg:"video/mpeg",ogg:"video/ogg",ogv:"video/ogg",avi:"video/avi",flv:"video/x-flv"},AUDIO:{mp3:"audio/mpeg",mpeg:"audio/mpeg",mp4:"audio/mp4",flac:"audio/flac",ogg:"audio/ogg",wav:"audio/vnd.wave"}};return n(s,e),s.STATE={IDLE:0,IN_PROGRESS:1,COMPLETED:2,FAILED:3,ABORTED:4},s.TYPE={IMAGE:"image",VIDEO:"video",AUDIO:"audio"},s.prototype.init=function(){if(!(this.queue.length<1)){i("[AssetLoader]::init()");var e=this.queue.length;this._xhrs=[],this._pending=e;for(var t=0;e>t;t++){var n=this.queue[t];i("[AssetLoader]::Started loading: "+n.path);var r=this.getXHR({id:t,path:n.path,type:n.type});r.send(),this._xhrs.push(r)}}},s.prototype.destroy=function(){if(this._xhrs){for(var e=this._xhrs.length,t=0;e>t;t++){var n=this._xhrs[t];n.abort(),this._xhrs[t]=null}this._queue=null,this._assets=null,this._bytesLoaded=null,this._bytesTotal=null}this._state=s.STATE.IDLE},s.prototype.enqueue=function(){if(t(arguments&&arguments.length>0,"There are no arguments specified."),t(this.state!==s.STATE.IN_PROGRESS,"Enqueueing is prohibited when the state is in progress."),arguments&&!(arguments.length<=0)&&this.state!==s.STATE.IN_PROGRESS){i("[AssetLoader]::enqueue("+arguments+")");for(var e=arguments.length,n=0;e>n;n++){var r=arguments[n];t("string"==typeof r||"object"==typeof r,'Each item to be enqueued must be a string of the target path or an object containing a "path" key and/or a "type" key'),t("string"==typeof r||"string"==typeof r.path,"Invalid path specified: "+r.path+".");var u="string"==typeof r?r:r.path,d=r.type;if(!d){var h=u.split(".").pop().toLowerCase();if(a.indexOf(h)>-1)d=s.TYPE.IMAGE;else if(o.indexOf(h)>-1)d=s.TYPE.VIDEO;else{if(!(l.indexOf(h)>-1))throw"[AssetLoader]::Unsupported asset format: "+u;d=s.TYPE.AUDIO}}d&&(this.queue.push({path:u,type:d}),this._bytesLoaded||(this._bytesLoaded=[]),this._bytesTotal||(this._bytesTotal=[]),this._bytesLoaded.push(0),this._bytesTotal.push(0))}}},s.prototype.dequeue=function(){if(t(arguments&&arguments.length>0,"There are no arguments specified."),t(this.state!==s.STATE.IN_PROGRESS,"Dequeueing is prohibited when the state is in progress."),arguments&&!(arguments.length<=0)&&this.state!==s.STATE.IN_PROGRESS)for(var e=arguments.length,n=0;e>n;n++){var i=arguments[n];t("string"==typeof i,"Expecting path to be a string.");for(var r=this.queue.length,a=0;r>a;a++){var o=this.queue[a];if(o.path===i){this.queue.splice(a,1),this.bytesLoaded.splice(a,1),this.bytesTotal.splice(a,1);break}}}},s.prototype.getXHR=function(e){var t=e.path.split(".").pop().toLowerCase(),n=u[e.type.toUpperCase()][t];if(!n)throw"[AssetLoader]:: Unsupported asset format: "+e.path;var i=new XMLHttpRequest;return i.addEventListener("progress",this._onXHRProgress.bind(this),!1),i.addEventListener("load",this._onXHRLoadComplete.bind(this),!1),i.addEventListener("error",this._onXHRLoadError.bind(this),!1),i.addEventListener("abort",this._onXHRAbort.bind(this),!1),i.open("GET",e.path,this.async),i.overrideMimeType&&i.overrideMimeType(n),i.data=e,i},s.prototype._onXHRProgress=function(e){if(e.lengthComputable){var t=e.currentTarget,n=t.data.id,s=t.data.path,a=t.data.type,o=e.loaded,l=e.total;t.data.bytesLoaded=o,t.data.bytesTotal=l,this._bytesLoaded[n]=o,this._bytesTotal[n]=l,this._bytesLoaded||(this._bytesLoaded=[]),i('[AssetLoader]::_onXHRProgress("'+s+'":'+o+"/"+l+")");var u=new CustomEvent(r.OBJECT.PROGRESS,{bubbles:!0,cancelable:!0,detail:{id:n,path:s,type:a,pending:this._pending,loaded:this.bytesLoaded,total:this.bytesTotal}});this.dispatchEvent(u)}},s.prototype._onXHRLoadComplete=function(e){var t=e.currentTarget,n=t.data.id,s=t.data.path,a=t.data.type;i('[AssetLoader]::_onXHRLoadComplete("'+s+'"")'),this._pending--;var o=new CustomEvent(r.OBJECT.LOAD,{bubbles:!0,cancelable:!0,detail:{id:n,path:s,type:a,pending:this._pending,loaded:this.bytesLoaded,total:this.bytesTotal}});this.dispatchEvent(o)},s.prototype._onXHRLoadError=function(e){var t=e.currentTarget,n=t.data.id,s=t.data.path,a=t.data.type;i('[AssetLoader]::_onXHRLoadError("'+s+'"")'),this._pending--;var o=new CustomEvent(r.OBJECT.ERROR,{bubbles:!0,cancelable:!0,detail:{id:n,path:s,type:a,pending:this._pending,loaded:this.bytesLoaded,total:this.bytesTotal}});if(this.dispatchEvent(o),0===this._pending){var l=new CustomEvent(r.OBJECT.LOAD,{bubbles:!0,cancelable:!0,detail:{id:n,path:s,type:a,pending:this._pending,loaded:this.bytesLoaded,total:this.bytesTotal}});this.dispatchEvent(l)}},s.prototype._onXHRAbort=function(e){var t=e.currentTarget,n=t.data.id,s=t.data.path,a=t.data.type;i('[AssetLoader]::_onXHRLoadError("'+s+'"")'),this._pending--;var o=new CustomEvent(r.OBJECT.ABORT,{bubbles:!0,cancelable:!0,detail:{id:n,path:s,type:a,pending:this._pending,loaded:this.bytesLoaded,total:this.bytesTotal}});if(this.dispatchEvent(o),0===this._pending){var l=new CustomEvent(r.OBJECT.LOAD,{bubbles:!0,cancelable:!0,detail:{id:n,path:s,type:a,pending:this._pending,loaded:this.bytesLoaded,total:this.bytesTotal}});this.dispatchEvent(l)}},s.prototype.__define_properties=function(){Object.defineProperty(this,"state",{get:function(){return this._state||Object.defineProperty(this,"_state",{value:s.STATE.IDLE,writable:!0}),this._state}}),Object.defineProperty(this,"queue",{get:function(){return this._queue||Object.defineProperty(this,"_queue",{value:[],writable:!0}),this._queue}}),Object.defineProperty(this,"assets",{get:function(){return this._assets||Object.defineProperty(this,"_assets",{value:{},writable:!0}),this._assets}}),Object.defineProperty(this,"async",{get:function(){return void 0===this._async?!0:this._async},set:function(e){t(this.state!==s.STATE.IN_PROGRESS,"Cannot change the async mode while it is in progress."),this.state!==s.STATE.IN_PROGRESS&&Object.defineProperty(this,"_async",{value:e,writable:!0})}}),Object.defineProperty(this,"bytesLoaded",{get:function(){if(this._bytesLoaded){for(var e=0,t=this._bytesLoaded.length,n=0;t>n;n++)e+=this._bytesLoaded[n];return e}return 0}}),Object.defineProperty(this,"bytesTotal",{get:function(){if(this._bytesTotal){for(var e=0,t=this._bytesTotal.length,n=0;t>n;n++)e+=this._bytesTotal[n];return e}return 0}}),Object.defineProperty(this,"progress",{get:function(){if(!this._bytesTotal||!this._bytesLoaded)return 0;if(this._bytesTotal.length!==this._bytesLoaded.length)return 0;for(var e=this._bytesTotal.length,t=0,n=0;e>n;n++){var i=this._bytesLoaded[n],r=this._bytesTotal[n];r>0&&(t+=i/r)}return t/e}}),s.__super__.__define_properties.call(this)},s}),n("net",["net/AssetLoader"],function(e){var t={};return Object.defineProperty(t,"AssetLoader",{value:e,writable:!1,enumerable:!0}),t}),n("types/KeyCode",{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE_BREAK:19,CAPS_LOCK:20,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LEFT_CMD:91,RIGHT_CMD:92,SELECT:93,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMI_COLON:186,EQUAL:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222}),n("types",["types/Directives","types/DirtyType","types/EventType","types/KeyCode","types/NodeState"],function(e,t,n,i,r){var s={};return Object.defineProperty(s,"Directives",{value:e,writable:!1,enumerable:!0}),Object.defineProperty(s,"DirtyType",{value:t,writable:!1,enumerable:!0}),Object.defineProperty(s,"EventType",{value:n,writable:!1,enumerable:!0}),Object.defineProperty(s,"KeyCode",{value:i,writable:!1,enumerable:!0}),Object.defineProperty(s,"NodeState",{value:r,writable:!1,enumerable:!0}),s}),n("ui",["ui/Element","ui/ElementUpdateDelegate","ui/Video"],function(e,t,n){var i={};return Object.defineProperty(i,"Element",{value:e,writable:!1,enumerable:!0}),Object.defineProperty(i,"ElementUpdateDelegate",{value:t,writable:!1,enumerable:!0}),Object.defineProperty(i,"Video",{value:n,writable:!1,enumerable:!0}),i}),n("utils/getClassIndex",["helpers/assert","ui/Element"],function(e,t){function n(n,i){if(!e(n&&(n instanceof HTMLElement||n instanceof t||n.jquery),"Invalid element specified. Element must be an instance of HTMLElement or Element."))return null;if(n instanceof t&&(n=n.element),n.jquery&&(n=n.get(0)),!e(i&&"string"==typeof i,"Invalid class name: "+i))return-1;var r=n.className.split(" ");return r.indexOf(i)}return n}),n("utils/hasClass",["helpers/assert","helpers/toElementArray","ui/Element","utils/getClassIndex"],function(e,t,n,i){function r(n,r){if(!e(r&&"string"==typeof r,"Invalid class name: "+r))return!1;for(var s=t(n),a=s.length,o=0;a>o;o++){var l=s[o];if(i(l,r)<0)return!1}return!0}return r}),n("utils/addClass",["helpers/assert","helpers/toElementArray","utils/hasClass"],function(e,t,n){function i(i,r){var s=t(i),a=[],o=s.length;if(e("string"==typeof r||r instanceof Array,"Invalid class name specified. Must be either a string or an array of strings.")){"string"==typeof r?a.push(r):a=r;for(var l=a.length,u=0;o>u;u++)for(var d=s[u],h=0;l>h;h++){var p=a[h];e("string"==typeof p,"Invalid class detected: "+p)&&(n(d,p)||(d.className=d.className+(""===d.className?"":" ")+p))}}}return i}),n("utils/getElementState",["helpers/assert","types/Directives","ui/Element"],function(e,t,n){function i(i){if(!e(i&&(i instanceof HTMLElement||i instanceof n||i.jquery),"Invalid element specified."))return null;i.jquery&&(i=i.get(0));var r;return r=i instanceof n?i.state:i.getAttribute(t.State)||i.getAttribute("data-"+t.State),r&&""!==r?r:null}return i}),n("utils/changeElementState",["helpers/assert","helpers/toElementArray","types/Directives","ui/Element","utils/getElementState"],function(e,t,n,i,r){function s(e,s){var a=t(e,!0);if(a)for(var o=a.length,l=0;o>l;l++){var u=a[l];r(u)!==s&&(u instanceof i?u.state=s:u.setAttribute("data-"+n.State,s))}}return s}),n("utils/getViewportRect",["helpers/assert"],function(e){function t(){if(!e(window&&document,"Window or document undefined."))return null;var t={};return t.width=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t.height=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t.top=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,t.left=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t.bottom=t.top+t.height,t.right=t.left+t.width,t}return t}),n("utils/getRect",["helpers/assert","helpers/toElementArray","ui/Element","utils/getViewportRect"],function(e,t,n,i){function r(n,s){if(!e(window,"This method relies on the window object, which is undefined."))return null;if(n===window)return i();s||(s=window);var a=t(n),o=a.length;if(0>=o)return null;var l=r(s);if(!e(l,"Cannot determine reference FOV."))return null;for(var u=r(window),d={},h=0;o>h;h++){var p=a[h],f=p.getBoundingClientRect(),c=f.width,m=f.height,v=f.top+u.top;s!==window&&(v-=l.top);var y=f.left+u.left;s!==window&&(y-=l.left);var E=v+m,g=y+c;void 0===d.left?d.left=y:d.left=Math.min(d.left,y),void 0===d.right?d.right=g:d.right=Math.max(d.right,g),void 0===d.top?d.top=v:d.top=Math.min(d.top,v),void 0===d.bottom?d.bottom=E:d.bottom=Math.max(d.bottom,E)}return d.width=d.right-d.left,d.height=d.bottom-d.top,d}return r}),n("utils/getIntersectRect",["helpers/assert","ui/Element","utils/getRect"],function(e,t,n){function i(){if(!e(window,"This method relies on the window object, which is undefined."))return null;var t=arguments.length;if(!e(t>0,"This method requires at least 1 argument specified."))return null;for(var i,r,s={},a=0;t>a;a++){if(i||(i=n(arguments[a])),!e(i,"Invalid computed rect."))return null;if(0===a&&a+1===t)r=n(window);else{if(!(t>a+1))break;r=n(arguments[a+1])}if(!e(r,"Invalid computed rect."))return null;s.width=Math.max(0,Math.min(i.right,r.right)-Math.max(i.left,r.left)),s.height=Math.max(0,Math.min(i.bottom,r.bottom)-Math.max(i.top,r.top)),s.top=Math.max(i.top,r.top),s.left=Math.max(i.left,r.left),s.bottom=s.top+s.height,s.right=s.left+s.width,s.width*s.height===0&&(s.width=0,s.height=0,s.top=0,s.left=0,s.bottom=0,s.right=0),i=s}return s}return i}),n("utils/hitTestElement",["helpers/assert","helpers/toElementArray","utils/getIntersectRect","utils/getRect"],function(e,t,n,i){function r(){if(!e(arguments.length>1,"Insufficient arguments. Expecting at least 2."))return!1;var t=Array.prototype.slice.call(arguments),r="object"==typeof t[0]&&t[0].hasOwnProperty("x")&&t[0].hasOwnProperty("y");if(r){for(var s=t.shift(),a=t.length,o=!1,l=0;a>l;l++){var u=i(t[l]),d=s.x>=u.left&&s.x<=u.right,h=s.y>=u.top&&s.x<=u.bottom;d&&h&&(o=!0)}return o}var p=n.apply(null,arguments);return e(p,"Invalid elements specified.")?p.width*p.height!==0:!1}return r}),n("utils/hitTestRect",["helpers/assert","helpers/toElementArray","utils/getIntersectRect","utils/getRect"],function(e,t,n,i){function r(){if(!e(arguments.length>1,"Insufficient arguments. Expecting at least 2."))return!1;var t=Array.prototype.slice.call(arguments),i="object"==typeof t[0]&&t[0].hasOwnProperty("x")&&t[0].hasOwnProperty("y");if(i){for(var r=t.shift(),s=t.length,a=!1,o=0;s>o;o++){var l=t[o];if(!e(!(void 0===l.top||isNaN(l.top)||void 0===l.right||isNaN(l.right)||void 0===l.bottom||isNaN(l.bottom)||void 0===l.left||isNaN(l.left)),'Invalid rect supplied. Rect must be an object containing "top", "right", "bottom", and "left" key values.'))return!1;var u=r.x>=l.left&&r.x<=l.right,d=r.y>=l.top&&r.x<=l.bottom;u&&d&&(a=!0)}return a}var h=n.apply(null,arguments);return e(h,"Invalid elements specified.")?h.width*h.height!==0:!1}return r}),n("utils/removeClass",["helpers/assert","helpers/toElementArray"],function(e,t){function n(n,i){var r=t(n),s=[],a=r.length;if(e("string"==typeof i||i instanceof Array,"Invalid class name specified. Must be either a string or an array of strings.")){"string"==typeof i?s.push(i):s=i;for(var o=s.length,l=0;a>l;l++)for(var u=r[l],d=0;o>d;d++){var h=s[d];if(e("string"==typeof h,"Invalid class detected: "+h)){var p=new RegExp("^"+h+"\\s+|\\s+"+h,"g");u.className=u.className.replace(p,"")}}}}return n}),n("utils/transform",["helpers/assert","helpers/toElementArray","utils/getRect"],function(e,t,n){function i(i,r,s){var a=t(i),o=a.length;if(r){if(!e(void 0===r.width||!isNaN(r.width),"Width property must be a number."))return null;if(!e(void 0===r.height||!isNaN(r.height),"Height property must be a number."))return null;if(!e(void 0===r.aspectRatio||!isNaN(r.aspectRatio),"Aspect ratio property must be a number."))return null;var l=n(i),u=r.units||"px",d=void 0!==r.aspectRatio?Number(r.aspectRatio):l.width/l.height,h=r.width,p=r.height,f=r.width,c=r.height,m=r.type||"default";s&&"default"!==m&&(e(void 0===s.width||!isNaN(s.width),"Width constraint must be a number."),e(void 0===s.height||!isNaN(s.height),"Height constraint must be a number."),m&&"cover"===m?(void 0!==s.width&&(f=Math.min(s.width,f)),void 0!==s.width&&(c=Math.min(s.height,c))):(void 0!==s.width&&(h=Math.min(s.width,h)),void 0!==s.height&&(p=Math.min(s.height,p))));var v,y;"contain"===m?(v=h>p?p*d:h,y=h>p?p:h/d,v>h?(v=h,y=v/d):y>p&&(y=p,v=y*d)):"cover"===m?(v=f>c?c*d:f,y=f>c?c:f/d,f>v?(v=f,y=v/d):c>y&&(y=c,v=y*d)):(v=h,y=p);for(var E=0;o>E;E++){var g=a[E];void 0!==r.width&&(g.style.width=String(v)+u),void 0!==r.height&&(g.style.height=String(y)+u)}var b={};return void 0!==r.width&&(b.width=v),void 0!==r.height&&(b.height=y),b}for(var O=0;o>O;O++)a[O].style.width="initial",a[O].style.height="initial";return{width:"initial",height:"initial"}}return i}),n("utils/translate",["helpers/assert","helpers/toElementArray"],function(e,t){function n(n,i,r){var s=t(n),a=s.length;if(i){if(!e(void 0===i.top||!isNaN(i.top),"Top property must be a number."))return null;if(!e(void 0===i.right||!isNaN(i.right),"Right property must be a number."))return null;if(!e(void 0===i.bottom||!isNaN(i.bottom),"Bottom property must be a number."))return null;if(!e(void 0===i.left||!isNaN(i.left),"Left property must be a number."))return null;var o=i.units||"px";if(r){if(!e(void 0===r.top||!isNaN(r.top),"Top constraint must be a number."))return null;if(!e(void 0===r.right||!isNaN(r.right),"Right constraint must be a number."))return null;if(!e(void 0===r.bottom||!isNaN(r.bottom),"Bottom constraint must be a number."))return null;if(!e(void 0===r.left||!isNaN(r.left),"Left constraint must be a number."))return null}for(var l=r&&void 0!==r.top?Math.min(i.top,r.top):i.top,u=r&&void 0!==r.right?Math.min(i.right,r.right):i.right,d=r&&void 0!==r.bottom?Math.min(i.bottom,r.bottom):i.bottom,h=r&&void 0!==r.left?Math.min(i.left,r.left):i.left,p=0;a>p;p++)void 0!==i.top&&(s[p].style.top=String(l)+o),void 0!==i.right&&(s[p].style.right=String(u)+o),void 0!==i.bottom&&(s[p].style.bottom=String(d)+o),void 0!==i.left&&(s[p].style.left=String(h)+o);var f={};return void 0!==i.top&&(f.top=l),void 0!==i.right&&(f.right=u),void 0!==i.bottom&&(f.bottom=d),void 0!==i.left&&(f.left=h),f}for(var c=0;a>c;c++)s[c].style.top="initial",s[c].style.right="initial",s[c].style.bottom="initial",s[c].style.left="initial";return{top:"initial",right:"initial",bottom:"initial",left:"initial"}}return n}),n("utils/translate3d",["helpers/assert","helpers/toElementArray"],function(e,t){function n(n,i,r){var s=t(n),a=s.length;if(i){if(!e(void 0===i.x||!isNaN(i.x),"X property must be a number."))return null;if(!e(void 0===i.y||!isNaN(i.y),"Y property must be a number."))return null;if(!e(void 0===i.z||!isNaN(i.z),"Z property must be a number."))return null;var o=i.units||"px";if(r){if(!e(void 0===r.x||!isNaN(r.x),"X constraint must be a number."))return null;if(!e(void 0===r.y||!isNaN(r.y),"Y constraint must be a number."))return null;if(!e(void 0===r.z||!isNaN(r.z),"Z constraint must be a number."))return null}var l=r&&void 0!==r.x?Math.min(i.x,r.x):i.x,u=r&&void 0!==r.y?Math.min(i.y,r.y):i.y,d=r&&void 0!==r.z?Math.min(i.z,r.z):i.z,h=void 0!==i.x?"translateX("+l+o+")":null,p=void 0!==i.y?"translateY("+u+o+")":null,f=void 0!==i.z?"translateZ("+d+o+")":null,c="";h&&(c+=""===c?h:" "+h),p&&(c+=""===c?p:" "+p),f&&(c+=""===c?f:" "+f);for(var m=0;a>m;m++)s[m].style.transform=c;var v={};return h&&(v.x=l),p&&(v.y=u),f&&(v.z=d),v}for(var y=0;a>y;y++)s[y].style.transform="translateX(0) translateY(0) translateZ(0)";return{x:0,y:0,z:0}}return n}),n("utils",["utils/addClass","utils/changeElementState","utils/getClassIndex","utils/getElementState","utils/getIntersectRect","utils/getRect","utils/getViewportRect","utils/hasClass","utils/hasChild","utils/hitTestElement","utils/hitTestRect","utils/removeClass","utils/transform","utils/translate","utils/translate3d"],function(e,t,n,i,r,s,a,o,l,u,d,h,p,f,c){var m={};return Object.defineProperty(m,"addClass",{value:e,writable:!1,enumerable:!0}),Object.defineProperty(m,"changeElementState",{value:t,writable:!1,enumerable:!0}),Object.defineProperty(m,"hasClass",{value:o,writable:!1,enumerable:!0}),Object.defineProperty(m,"hasChild",{value:l,writable:!1,enumerable:!0}),Object.defineProperty(m,"getClassIndex",{value:n,writable:!1,enumerable:!0}),Object.defineProperty(m,"getElementState",{value:i,writable:!1,enumerable:!0}),Object.defineProperty(m,"getIntersectRect",{value:r,writable:!1,enumerable:!0}),Object.defineProperty(m,"getRect",{value:s,writable:!1,enumerable:!0}),Object.defineProperty(m,"getViewportRect",{value:a,writable:!1,enumerable:!0}),Object.defineProperty(m,"hitTestElement",{value:u,writable:!1,enumerable:!0}),Object.defineProperty(m,"hitTestRect",{value:d,writable:!1,enumerable:!0}),Object.defineProperty(m,"removeClass",{value:h,writable:!1,enumerable:!0}),Object.defineProperty(m,"translate",{value:f,writable:!1,enumerable:!0}),Object.defineProperty(m,"translate3d",{value:c,writable:!1,enumerable:!0}),Object.defineProperty(m,"transform",{value:p,writable:!1,enumerable:!0}),m}),n("requiem",["helpers/injectModule","helpers/polyfill","dom","events","net","types","ui","utils"],function(e,t,n,i,r,s,a,o){var l={};return Object.defineProperty(l,"name",{value:"Requiem",writable:!1}),Object.defineProperty(l,"version",{value:"0.7.1",writable:!1}),e(l,"dom",n),e(l,"events",i),e(l,"net",r),e(l,"types",s),e(l,"ui",a),e(l,"utils",o),t(),l}),t("requiem")}());